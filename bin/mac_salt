#!/bin/bash

MACSALT=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )

function help_function () {
	echo -e "
Add the following to .bash_profile or .bashrc to source the MAC SALT bash configuration: 

if [ -f ~/.mac_salt/bash_config ]; then
	source ~/.mac_salt/bash_config
fi

Seperate your ssh Proxy settings with a comment at the bottom of your ssh config file.

Host *
	KeepAlive yes
	###### Do not place anything below this line.  It will be updated frequently by the proxy update functions.
	ProxyCommand /usr/local/bin/corkscrew 127.0.0.1 8840 %h %p
"
}

case $@ in
	bootstrap)
		$MACSALT/../bootstrap.sh
		;;
	help)
		help_function
		;;
	update)
		cd $MACSALT/..
		git pull
		;;
	*)
		$MACSALT/grains.sh
		sudo -H -E salt-call --local --file-root=$MACSALT/../salt --pillar-root=$MACSALT/../pillar $@
esac