#!/bin/bash

MACSALT=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )

function help_function () {
	echo -e "
options:

alias
bootstrap
doctor
function
help
source
update
state.highstate
state.sls <sls>

If you are running issues running mac_salt then you should try running: 'mac_salt' doctor to see if there are any issues with the setup.
"
}

case $@ in
	alias|aliases)
		cat ~/.mac_salt/aliases | grep "alias" | awk '{ $1=""; print $0 }' | sort -n 
		;;
	bootstrap)
		$MACSALT/../bootstrap.sh
		;;
	doctor)
		$MACSALT/ms_doctor.sh
		;;
	function|functions)
		cat ~/.mac_salt/functions | grep "^##" | awk '{ $1=""; print $0 }' | grep -v '^-' | sort -n 
		cat ~/.mac_salt/git_functions | grep "^##" | awk '{ $1=""; print $0 }' | grep -v '^-' | sort -n 
		;;
	help)
		help_function
		;;
	source)
		echo -e "source ~/.mac_salt/bash_config" | tr -d '\n' | pbcopy
		echo -e "paste clipboard into terminal."
		;;
	update)
		cd $MACSALT/..
		git pull
		;;
	state.*)
		$MACSALT/grains.sh
		sudo -H -E salt-call --local --file-root=$MACSALT/../salt --pillar-root=$MACSALT/../pillar $@
		;;
	*)
		help_function
esac