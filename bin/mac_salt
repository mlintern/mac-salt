#!/bin/bash

MACSALT=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )

function help_function () {
	echo -e "
options:

alias
bootstrap
doctor
function
help
source
update

do:
	help
	update

pillar:
	raw

state:
	highstate
	sls <sls>


If you are running issues running mac_salt then you should try running: 'mac_salt' doctor to see if there are any issues with the setup.
"
}

case $@ in
	alias|aliases)
		echo -e "aliases:"
		cat ~/.mac_salt/aliases | grep "^alias" | awk '{ $1=""; print $0 }' | sort -n 
		echo -e "\nprofile:"
		cat ~/.mac_salt/profile | grep "^alias" | awk '{ $1=""; print $0 }' | sort -n
		;;
	bootstrap)
		$MACSALT/../bootstrap.sh
		;;
	doctor)
		$MACSALT/ms_doctor.sh
		;;
	function|functions)
		echo -e "functions:"
		cat ~/.mac_salt/functions | grep "^##" | awk '{ $1=""; print $0 }' | grep -v '^-' | sort -n 
		echo -e "\ngit_functions:"
		cat ~/.mac_salt/git_functions | grep "^##" | awk '{ $1=""; print $0 }' | grep -v '^-' | sort -n 
		echo -e "\nprofile:"
		cat ~/.mac_salt/profile | grep "^##" | awk '{ $1=""; print $0 }' | grep -v '^-' | sort -n
		;;
	help)
		help_function
		;;
	source)
		echo -e "source ~/.mac_salt/bash_config" | tr -d '\n' | pbcopy
		echo -e "paste clipboard into terminal."
		;;
	update)
		cd $MACSALT/..
		git pull
		;;
	state.*|do.*|pillar.*|go.*)
		$MACSALT/grains.sh
		sudo -H -E salt-call --state-output=changes --local --file-root=$MACSALT/../salt --pillar-root=$MACSALT/../pillar $@
		;;
	*)
		help_function
esac